---
noteId: "f575d650d69f11f0bb22571048cde195"
tags: []

---

## **반려동물 안구 질환 분류 프로젝트**
- 본 프로젝트는 11가지 반려견 안구질환을 정확히 분류하는 딥러닝모델을 학습하고,
- Flask 기반의 웹 애플리케이션을 통해 누구나 손쉽게 진단 결과를 확인할 수 있도록 접근성과 활용도를 대폭 향상시킨 연구입니다.

## **프로젝트 개요**
- 반려견 안구 이미지에서 11개 질환(10개질환 + 정상 1개)을 분류하는 모델 학습(fine-tuning)
- ResNet50, ViT 같은 딥러닝 모델과 RandomForest, XGBoost, Stacking 같은 머신러닝 앙상블 모델 성능 비교 후 최적의 모델 선택
- Flask 웹 애플리케이션으로 이미지 업로드 → 분류 → 결과 확인 통합 제공
---

## **데이터셋 및 체크포인트 다운로드**
```bash
https://www.dropbox.com/scl/fi/86v6he5jc3wi1bkvouq0r/data.zip?rlkey=w3a9rexq9v4d02b1zxv98b2pr&st=2lku0bqf&dl=0
```
---

## **사용 방법**

1. 리포지토리 클론
```bash
cd PPE-ProtectPetEyes
```

2. 의존성 패키지 설치
```bash
pip install -r requirements.txt
```
3. 모델 체크포인트 다운로드
```bash
제공된 링크에서 best_finetuned_resnet.pth 파일을 프로젝트 루트에 저장
```
4. 웹 애플리케이션 실행
```bash
python app.py
```
6. 브라우저에서 접속
```bash
http://127.0.0.1:7860
```
6. 이미지 업로드 및 결과 확인
```bash
- “이미지 선택” 버튼을 눌러 강아지 안구 사진을 업로드합니다.
- “분류 실행”을 클릭하면 상위 4개 질환 예측 결과가 표시됩니다.
```
---

## **사용 예시**
![a](https://github.com/user-attachments/assets/30b31640-b2f1-47c6-8b50-31b5be34ee6a)
![b](https://github.com/user-attachments/assets/cb855ceb-011e-44ef-91b9-c0fda9d5aeae)

---
## **1. 문제 정의**

### **1.1 문제의 맥락 및 진술**  
- 반려동물의 **안구 질환**은 조기에 발견하지 않으면 악화될 위험이 큽니다.
- 하지만 반려동물 주인이 스스로 증상을 판단하기 어려워 병원 방문이 지연되기도 합니다. 이는 **시간적·경제적 부담**을 초래하며 질환 악화 가능성을 높입니다.
- 본 프로젝트의 목표는 **반려동물의 안구 이미지를 분석**하여 **질환의 유무와 종류를 분류**하는 모델을 개발하는 것입니다.
- 또한, 질병 가능성을 감지하면 **경고**를 제공해 반려동물 주인이 조기에 대응할 수 있도록 지원하고자 합니다.

### **1.2 목표, 과정 및 성공 기준**  

**목표**  
- 반려동물의 안구 이미지로 **질환 유무**를 정확히 분류  
- 주요 질환(결막염, 각막염 등)을 정확하게 구분하는 시스템 구축  
- 질병 가능성을 감지해 **경고를 제공**하는 사용자 친화적 시스템 설계  

**과정**  
1. 반려동물 안구 질환 데이터셋 수집 및 전처리  
2. **5개 모델**의 학습(finetuing) 후 성능 비교: ViT, ResNet, Random Forest, Stacking, Boosting  
3. 최적 모델 선정 및 **성능 최적화** 기법 적용  
4. 최종 모델 배포 및 **웹 애플리케이션** 구현  

**성공 기준**  
- 모델 테스트 정확도 **70% 이상** 달성  
- 제한된 리소스 내에서 최적화된 모델 훈련  
- 사용자에게 **예측 결과를 시각화**하고 직관적으로 제공  

---

## **2. 프로젝트 진행 과정**

### **2.1 데이터셋 출처**  
- AI HUB에서 제공하는 실제 반려동물 안구질환 데이터셋 사용
- 다양한 해상도·크기의 이미지로 구성

### **2.2 데이터 구성**  
- 총 55,000개 이미지, 11개 클래스(질환 10 + 정상 1)
- 각 클래스별 학습 4,000장, 테스트 1,000장 비율로 구성
- 클래스별 순차 편향 방지를 위해 랜덤 샘플링(클래스당 5,000장)

### **2.3 데이터셋 전처리**  
1. 라벨 정제: : AI Hub에서 제공하는 데이터셋은 진단 부위, 좌표, 질환명 및 질환 정도 등 다중 라벨링 정보를 포함한 Multi-Label 데이터셋. 단일 레이블(안구 질환명)만 남기고 다른 레이블 제거.
2. 이미지 크기 조정: ResNet·ViT 표준 입력 크기인 224×224로 통일
3. 데이터 증강
   - RandomHorizontalFlip (50% 좌우 반전)
   - RandomRotation (±20도 회전)
   - ColorJitter (밝기·대비·채도 변화)
4. 텐서 변환: PyTorch 모델 입력용 Tensor로 변환
5. 정규화: ImageNet 사전학습 표준(mean/std) 값으로 정규화
6. 파이프라인 구축: transforms.Compose로 일괄 전처리 적용

### **2.4 모델 학습**
다섯 가지 모델을 실험 및 비교하였습니다:  
1. **Vision Transformer (ViT)**  
2. **ResNet50 (Residual Network)**  
3. **Random Forest**  
4. **Stacking Ensemble**  
5. **Boosting Algorithm (XGBoost)**

###  **2.5 웹 애플리케이션 구축**
- Flask 기반의 간단하면서도 직관적인 웹 인터페이스를 구현.
- 업로드된 이미지는 실시간으로 미리보기되며, “분류 실행” 버튼 클릭 한 번으로 상위 4개 질환 예측 결과와 확률을 확인.
---

## **3. 모델 성능 비교 및 결과**

### **3.1 Metrics**  
- Accruacy
- Train Time


### **3.2 최적 모델 선정**  
- 성능 비교 결과 **ResNet50**이 가장 높은 정확도(52.1%)를 기록하여 최적의 모델로 선정되었습니다.
- 선정된 ResNet모델에 추가적인 데이터 전처리를 통해 최종적인 성능(53.4%)의 성능을 얻었습니다.

### **3.3 주요 성능 결과**  
| **모델**            | **테스트 정확도** | **학습 시간 (30 epochs)** | 
|---------------------|-----------------|-----------------| 
| Vision Transformer  | 51.8%            |  7h 24m        |
| **ResNet50** (최종 선정) | **53.4%**        |  9h 17m   |
| Random Forest       | 35.2%            |  30m           |
| Stacking Ensemble   | 47.0%            |  15h           |
| XGBoost             | 40.2%            |  21m           |

---

## **4. 결론**  
- 본 프로젝트는 반려동물의 안구 이미지를 분석하여 **질환의 유무와 종류를 분류**하는 모델을 개발했습니다.
- 다양한 모델을 실험한 결과 **ResNet50**이 가장 우수한 성능을 보였으며, 성능 최적화를 통해 **53.4%의 테스트 정확도**를 달성했습니다.
- 최종적으로 웹 애플리케이션을 구현하여 사용자가 이미지를 업로드하면 **질병 예측 결과와 경고**를 제공하는 시스템을 설계했습니다.
- 이를 통해 반려동물 주인이 질병을 조기에 인지하고 적절히 대응할 수 있도록 지원하고자 했습니다.

---



## **5. 한계점 및 개선 방향**

### **5.1 한계점**  
1. **질환 간 유사성**: 비궤양성 각막질환과 색소침착성 각막염과 같은 특정 질환은 이미지 간 차이가 미세해 모델이 구분하기 어려웠습니다.  
2. **평가지표 한정**: 정확도(Accuracy)만 사용하여 F1 Score와 같은 균형 잡힌 평가가 부족했습니다.  
3. **데이터셋 샘플링 문제**: 기존 데이터셋의 질병 중증도(상·중·하)를 고려하지 않은 랜덤 샘플링으로 클래스 간 유사성이 모델 성능 저하에 영향을 주었습니다.  
4. **Epoch 수 부족**: 학습 Epoch 수가 부족해 딥러닝 모델이 충분히 수렴하지 못했습니다.
5. **목표 Accuray 달성실패** : 프로젝트의 성공으로 잡았던 70%의 Accuracy를 달성하지 못했습니다.

### **5.2 개선 방향**  
1. 추가적인 레이블링기법으로 질병 중증도(상,중,하) 고려하여 학습  
2. F1 Score와 같은 지표를 도입해 모델 성능 평가 강화  
3. Epoch 수를 늘려 모델 학습을 충분히 진행  

